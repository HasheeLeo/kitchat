{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/extends","data":{"isAsync":false}},{"name":"react-native-fs","data":{"isAsync":false}},{"name":"../app/LocalStorage","data":{"isAsync":false}},{"name":"./base64ToType","data":{"isAsync":false}},{"name":"../constants","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _extends2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/helpers/extends\"));\n\n  var _reactNativeFs = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"react-native-fs\"));\n\n  var _LocalStorage = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"../app/LocalStorage\"));\n\n  var _base64ToType = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[5], \"./base64ToType\"));\n\n  var _constants = _$$_REQUIRE(_dependencyMap[6], \"../constants\");\n\n  function onMessageCreated(receiverId, message, attachment) {\n    var saveAttachmentPromise, withoutImageBlob;\n    return _regenerator.default.async(function onMessageCreated$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (attachment) {\n              attachWithMessage(message, attachment);\n              saveAttachmentPromise = _LocalStorage.default.saveFile(message._id, attachment.file);\n            }\n\n            withoutImageBlob = (0, _extends2.default)({}, message);\n            withoutImageBlob.image = undefined;\n            _context.next = 5;\n            return _regenerator.default.awrap(_LocalStorage.default.saveMessage(receiverId, withoutImageBlob));\n\n          case 5:\n            if (!saveAttachmentPromise) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 8;\n            return _regenerator.default.awrap(saveAttachmentPromise);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  }\n\n  function attachWithMessage(message, attachment) {\n    var typeData = (0, _base64ToType.default)(attachment.file);\n\n    if (typeData) {\n      var path = _reactNativeFs.default.DocumentDirectoryPath + \"/\" + message._id;\n      if (typeData.ext) path = path + \".\" + typeData.ext;\n      if (attachment.fileType === _constants.FileType.image) message.image = typeData.dataWithMime;else message.documentName = \"\" + attachment.fileName;\n      message.attachmentPath = path;\n    }\n  }\n\n  var _default = onMessageCreated;\n  exports.default = _default;\n});","lineCount":67,"map":[[13,0,3,0],[15,0,4,0],[17,0,5,0],[19,0,7,0],[21,0,10,0],[21,11,10,15,"onMessageCreated"],[21,27,10,0],[21,28,10,32,"receiverId"],[21,38,10,0],[21,40,10,52,"message"],[21,47,10,0],[21,49,11,2,"attachment"],[21,59,10,0],[22,0,10,0],[23,0,10,0],[24,0,10,0],[25,0,10,0],[26,0,10,0],[27,0,14,2],[27,16,14,6,"attachment"],[27,26,14,2],[27,28,14,18],[28,0,15,4,"attachWithMessage"],[28,14,15,4,"attachWithMessage"],[28,31,15,21],[28,32,15,22,"message"],[28,39,15,21],[28,41,15,31,"attachment"],[28,51,15,21],[28,52,15,4],[29,0,16,4,"saveAttachmentPromise"],[29,14,16,4,"saveAttachmentPromise"],[29,35,16,25],[29,38,16,28,"LocalStorage"],[29,60,16,41,"saveFile"],[29,68,16,28],[29,69,16,50,"message"],[29,76,16,57],[29,77,16,58,"_id"],[29,80,16,28],[29,82,16,63,"attachment"],[29,92,16,73],[29,93,16,74,"file"],[29,97,16,28],[29,98,16,4],[30,0,17,3],[32,0,18,6,"withoutImageBlob"],[32,12,18,6,"withoutImageBlob"],[32,28,10,0],[32,31,18,25],[32,54,18,39],[32,56,18,25],[32,58,18,43,"message"],[32,65,18,25],[32,66,10,0],[33,0,19,2,"withoutImageBlob"],[33,12,19,2,"withoutImageBlob"],[33,28,19,18],[33,29,19,19,"image"],[33,34,19,2],[33,37,19,27,"undefined"],[33,46,19,2],[34,0,10,0],[35,0,10,0],[35,46,20,8,"LocalStorage"],[35,68,20,21,"saveMessage"],[35,79,20,8],[35,80,20,33,"receiverId"],[35,90,20,8],[35,92,20,45,"withoutImageBlob"],[35,108,20,8],[35,109,10,0],[37,0,10,0],[38,0,10,0],[38,17,22,6,"saveAttachmentPromise"],[38,38,10,0],[39,0,10,0],[40,0,10,0],[41,0,10,0],[43,0,10,0],[44,0,10,0],[44,46,23,10,"saveAttachmentPromise"],[44,67,10,0],[46,0,10,0],[47,0,10,0],[48,0,10,0],[49,0,10,0],[50,0,10,0],[51,0,10,0],[52,0,10,0],[54,0,26,0],[54,11,26,9,"attachWithMessage"],[54,28,26,0],[54,29,26,27,"message"],[54,36,26,0],[54,38,26,53,"attachment"],[54,48,26,0],[54,50,26,77],[55,0,27,2],[55,8,27,8,"typeData"],[55,16,27,16],[55,19,27,19],[55,46,27,32,"attachment"],[55,56,27,42],[55,57,27,43,"file"],[55,61,27,19],[55,62,27,2],[57,0,28,2],[57,8,28,6,"typeData"],[57,16,28,2],[57,18,28,16],[58,0,29,4],[58,10,29,8,"path"],[58,14,29,12],[58,17,29,18,"RNFS"],[58,40,29,23,"DocumentDirectoryPath"],[58,61,29,12],[58,70,29,48,"message"],[58,77,29,55],[58,78,29,56,"_id"],[58,81,29,4],[59,0,30,4],[59,10,30,8,"typeData"],[59,18,30,16],[59,19,30,17,"ext"],[59,22,30,4],[59,24,31,6,"path"],[59,28,31,10],[59,31,31,16,"path"],[59,35,31,10],[59,44,31,24,"typeData"],[59,52,31,32],[59,53,31,33,"ext"],[59,56,31,6],[60,0,33,4],[60,10,33,8,"attachment"],[60,20,33,18],[60,21,33,19,"fileType"],[60,29,33,8],[60,34,33,32,"FileType"],[60,54,33,41,"image"],[60,59,33,4],[60,61,34,6,"message"],[60,68,34,13],[60,69,34,14,"image"],[60,74,34,6],[60,77,34,22,"typeData"],[60,85,34,30],[60,86,34,31,"dataWithMime"],[60,98,34,6],[60,99,33,4],[60,104,36,6,"message"],[60,111,36,13],[60,112,36,14,"documentName"],[60,124,36,6],[60,132,36,32,"attachment"],[60,142,36,42],[60,143,36,43,"fileName"],[60,151,36,6],[61,0,38,4,"message"],[61,6,38,4,"message"],[61,13,38,11],[61,14,38,12,"attachmentPath"],[61,28,38,4],[61,31,38,29,"path"],[61,35,38,4],[62,0,39,3],[63,0,40,1],[65,17,42,15,"onMessageCreated"],[65,33]],"functionMap":{"names":["<global>","onMessageCreated","attachWithMessage"],"mappings":"AAA;ACS;CDc;AEE;CFc"}},"type":"js/module"}]}